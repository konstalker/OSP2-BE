name: Telegram Notify on Push

on:
  push:
    branches:
      - main

jobs:
  telegram:
    runs-on: ubuntu-latest
    steps:
      - name: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          COMMIT_MSG="${{ github.head_commit.message }}"
          COMMIT_URL="${{ github.head_commit.url }}"

          # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º
          MESSAGE="*${COMMIT_MSG}*\n\n"
          MESSAGE="${MESSAGE}> ${COMMIT_MSG}\n"

          # –°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª
          MESSAGE="${MESSAGE}[zz-osp-pak8.pk3](https://github.com/snems/OSP2/releases/download/latest/zz-osp-pak8.pk3) "

          # –°—Å—ã–ª–∫–∞ –Ω–∞ —á–∞—Ç
          MESSAGE="${MESSAGE}[üí¨ –ß–∞—Ç](https://t.me/q3osp2be_chat)"

          # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram
          curl -s -X POST https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendMessage \
            -d chat_id="$TELEGRAM_CHAT_ID" \
            -d text="$MESSAGE" \
            -d parse_mode="Markdown"
