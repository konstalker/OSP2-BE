name: Telegram Notify on Push

on:
  push:
    branches:
      - main

jobs:
  telegram:
    runs-on: ubuntu-latest
    steps:
      - name: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          COMMIT_URL="${{ github.head_commit.url }}"
          COMMIT_MSG="${{ github.head_commit.message }}"
          COMMIT_AUTHOR="${{ github.head_commit.author.name }}"
          REPO_NAME="${{ github.repository }}"
          GITHUB_ACTOR="${{ github.actor }}"

          MESSAGE="‚úÖ *–ù–æ–≤—ã–π –∫–æ–º–º–∏—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏* _${REPO_NAME}_\n\nüë§ –ê–≤—Ç–æ—Ä: *${COMMIT_AUTHOR}*\nüßë‚Äçüíª –û—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: \`${GITHUB_ACTOR}\`\n\nüí¨ –°–æ–æ–±—â–µ–Ω–∏–µ:\n\`\`\`\n${COMMIT_MSG}\n\`\`\`\nüîó [–°–º–æ—Ç—Ä–µ—Ç—å –∫–æ–º–º–∏—Ç](${COMMIT_URL})"

          curl -s -X POST https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendMessage \
            -d chat_id="$TELEGRAM_CHAT_ID" \
            -d text="$MESSAGE" \
            -d parse_mode="Markdown"
